@using DTNL.UmbracoCms.Web.Components;
@using static DTNL.UmbracoCms.Web.Components.NavigationDesktop
@model DTNL.UmbracoCms.Web.Components.NavigationMobile;

<partial name="Modal" model="@(new Modal {Id = "navigation-mobile", Title="navigation-mobile", Size = "navigation-mobile", KeepScrollPosition = true, CloseAllOthers = true })">
        <div class="c-navigation-mobile">
            <nav title="{{ global.resource.navigation.mainNavigation }}">
                <partial name="./NavigationMobileListItem.cshtml" model="@(new Components.NavigationMobile
                    {
                        Items = Model.Items
                    })" />
                <div class="navigation-mobile__line"></div>
                <div class="navigation-mobile-selector">
                    <!-- Todo: language selector -->
                </div>
            </nav>
        </div>
</partial>


@foreach(MenuItem item in Model.Items)
{
    @if (item?.Submenu?.Items != null)
    {
        <partial name="Modal" model="@(new Modal {Id = $"navigation-mobile-{item.Id}", Size = "navigation-mobile", KeepScrollPosition = true, CloseAllOthers = true })">
            <div class="c-navigation-mobile">
                <partial name="./NavigationMobileListItem.cshtml" model="@(new Components.NavigationMobile
                    {
                        Items = item.Submenu.Items,
                        Header = new NavigationMobile.NavigationHeaderListItem {
                                Title = item.Submenu.Title,
                                Id = "navigation-mobile",
                        },
                        Parent = new NavigationMobile.NavigationListItem {
                                Title = item?.Submenu.Title,
                                Id = item?.Submenu.Id,
                        },
                    })"
                />               
            </div>
        </partial>
    }
}



@foreach (MenuItem item in Model.Items)
{
    @if (item?.Submenu?.Items != null)
    {
        @foreach (MenuItem subitem in item.Submenu.Items)
        {
            @if (subitem?.NestedSubmenu?.Links != null)
            {
                    <partial name="Modal" model="@(new Modal {Id = $"navigation-mobile-{item.Id}-{subitem.Id}", Size = "navigation-mobile", KeepScrollPosition = true, CloseAllOthers = true })">
                    <div class="c-navigation-mobile">
                            <partial name="./NavigationMobileListItem.cshtml" model="@(new Components.NavigationMobile
                                {
                                    Items = subitem?.NestedSubmenu?.Links ?? [],
                                    Header = new NavigationMobile.NavigationHeaderListItem {
                                            Title = subitem?.NestedSubmenu.Title,
                                            Id = $"navigation-mobile-{item.Id}",
                                    },
                                    Parent = new NavigationMobile.NavigationListItem {
                                            Title = item?.Submenu.Title,
                                            Id = subitem?.NestedSubmenu.Id,
                                    },
                                    AllLink = new Link { Url = subitem?.All != null ? subitem?.All?.Url : null, Label = subitem?.All != null ? subitem?.All?.Label : null}
                                })" 
                                />
                        </div>
                    </partial>
            }                   
        };
    }
}
; 
